k8s-master-conf:
  image: imikushin/rancheros-k8s
  labels:
  - io.rancher.os.detach=false
  - io.rancher.os.scope=system
  net: host
  links:
  - etcd
  - flannel
  - docker
  volumes_from:
  - all-volumes
  environment:
  - NODE_IP
  command: k8s-master-conf.sh

kube-master:
  image: gcr.io/google_containers/hyperkube:v0.16.2
  labels:
  - io.rancher.os.scope=system
  net: host
  links:
  - k8s-master-conf
  volumes:
  - /var/run/docker.sock:/var/run/docker.sock
  command: /hyperkube kubelet --api_servers=http://localhost:8080 --v=2 --address=0.0.0.0 --enable_server --hostname_override=127.0.0.1 --config=/etc/kubernetes/manifests-multi

kube-proxy:
  image: gcr.io/google_containers/hyperkube:v0.16.2
  labels:
  - io.rancher.os.scope=system
  privileged: true
  net: host
  links:
  - kube-master
  volumes:
  - /var/run/docker.sock:/var/run/docker.sock
  command: /hyperkube proxy --master=http://127.0.0.1:8080 --v=2
